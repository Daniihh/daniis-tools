/*!
 * Danii's Tools
 *
 * Copyright (c) 2019 Daniel Conley
 * Licensed under the GNU General Public License Version 3.
 * https://www.gnu.org/licenses/gpl-3.0.txt
 */
let defineProperties=(t,e)=>{Object.defineProperties(t,Object.keys(e).reduce((t,r)=>Object.assign(Object.assign({},t),{[r]:Object.assign(Object.assign({},Object.getOwnPropertyDescriptor(e,r)),{enumerable:!1})}),{}))};defineProperties(Array.prototype,{get last(){return this[Math.max(0,this.length-1)]},set last(t){this[Math.max(0,this.length-1)]=t},crumble(){let t={0:null,1:this[0],default:this};return this.length>1?t.default:t[this.length]},crumbleFlat(t){return this.flat(t).crumble()},reduceSkip(t,e){let r,n=!1,i=Symbol.skip,s=[];for(let l=0;l<this.length;l++){let o=this[l];if(!n){if(n=!0,!(arguments.length>1)){r=o;continue}r=Object.clone(e)}let u=t(r,o,i,l,this);u==i?(s.push(r),n=!1,l--):r=u}return n&&s.push(r),s},softReverse(){let t=[];for(let e of Array.from(this.entries()))t[-1*e[0]+this.length-1]=e[1];return t}}),defineProperties(Object,{clone(t){if("object"!=typeof t)return t;let e=t.constructor;return Object.assign(new e,t)},every(t,e,r){return this.entries(t).every((n,i)=>e.call(r,n,i,t))},filter(t,e,r){return this.fromEntries(this.entries(t).filter((n,i)=>e.call(r,n,i,t)))},getType:t=>Object.getPrototypeOf(t).constructor.name,objectHasOwnProperty:(t,e)=>[].hasOwnProperty.call(t,e),objectHasProperty(t,e){let r=[t];for(;null!==this.getPrototypeOf(r.last);)r.push(this.getPrototypeOf(r.last));return r.some(t=>this.objectHasOwnProperty(t,e))}}),defineProperties(String.prototype,{capitalize(){return this.substr(0,1).toUpperCase()+this.substr(1)},escape(t=!0){let e=this.split("");return t&&(e=e.map(t=>['"',"'","\\"].includes(t)?"\\"+t:t)),(e=e.map(t=>["\n","\r","\t"].includes(t)?"\\"+{"\n":"n","\r":"r","\t":"t"}[t]:t)).join("")},toTitleCase(){return this.split(" ").map(t=>t.toLowerCase().capitalize()).join(" ")},interpolate(t){let e=0,r=[],n=(t,e)=>r.push({content:t,type:e?"code":"string"});return[...this.matchAll(/\\?\$/g),null].forEach(t=>{if(t&&t[0].startsWith("\\"))return;let r=this.substring(e,t?t.index:this.length);if(r&&n(r),t){let r=findPairs(this,{"{":t=>++t,"}":t=>++t}),i=this.substring(t.index+2,r);i&&n(i,!0),e=r+1}}),r.reduce((e,r)=>e+("code"==r.type?(t=>null===t?"null":void 0===t?"undefined":"function"==typeof t.toString?t.toString():Object.prototype.toString.call(t))(evaluate(r.content,t)):r.content),"")}}),defineProperties(Symbol,{skip:Symbol("skip")});const keywords=["arguments","in","of","for","if","else","throw","while","do","with","function","let","const","var","new","return","delete"];export function bound(t,e,r){t.constructor==Object&&(r=t);let n=r.value;return delete r.writable,delete r.value,r.get=function(){return n.bind(this)},r}function withSelf(t,e,r){let n=r.value;return delete r.writable,delete r.value,r.get=function(){let t=this;return function(...e){return n.call(t,this,...e)}},r}function evaluate(t,e={}){let r=["this"],n={},i=(e=Object.filter(e,([t,e])=>{if(r.includes(t))return n[t]=e,!1;if(keywords.includes(t))throw new TypeError("Illegal argument name provided.");return!0}))?Object.keys(e):[],s=e?Object.values(e):[],l=`try{return eval("${t.escape()}")}catch(a){if(!(a `+'instanceof SyntaxError))throw a;let b=JSON.parse("'+JSON.stringify(i).escape()+'");return new Function(...b,"'+t.escape()+'")(...arguments)}';return new Function(...i,l).call(n.this?n.this:this,...s)}function findPairs(t,e,r,n){const[i,s,l,o]=t instanceof Array||"string"==typeof t||t instanceof String?["string"==typeof t?t.split(""):t,e,r||0,null==n?-1:n]:[this.split(""),t,e||0,null==r?-1:r];if(0==o)return l;const u=s[i[l]];return findPairs(i,s,l+1,u?u(-1==o?0:o):o)}